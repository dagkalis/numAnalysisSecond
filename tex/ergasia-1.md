Εργασία 2

# Γενικά
O κώδικας της εργασίας υλοποιήθηκε στην γλώσσα προγραμματισμού python. Μέσα στο αρχείο main.py υπάρχει ο κώδικας για την Άσκηση 5(1 και 3 υποερωτήματα) και για την άσκηση 7. Το παρόν παραδοτέο χωρίζεται σε δύο μέρη. Στο πρώτο μέρος επεξηγείται η λειτουργία του κώδικα και στο δεύτερο μέρος περιγράφονται οι λύσεις των ασκήσεων και τα αποτελέσματα τους.

# Υλοποίηση

## Main
Από εδώ ξεκινάει η εκτέλεση του κώδικα. Ο κώδικας συνολικά έχει φτιαχτεί έτσι ώστε να μπορούμε με το κάλεσμα μιας συνάρτησης να μπορούμε να πάρουμε να πάρουμε το αποτέλεσμα ενός ερωτήματος μέσα στην εργασία. Μέσα στην main υπάρχουν οι συναρτήσεις που λύνουν κάθε ερώτημα μέσα σε comment έτσι ώστε να μην μπερδέυονται τα αποτελέσματα μεταξύ του και να μην μπλοκάρει το ένα plot το άλλο. **Προσοχή:** Κατά την διάρκεια ένός plot η εκτέλεση του κώδικα σταματάει σε εκείνο το σημείο μέχρι να κλείσει το παράθυτο του plot. 
Μέσα στην main υπάρχουν οι παρακάτω συναρτήσεις: 

1. solveSinWithLagrange: Λύνει την πολυωνυμική προσέγγιση για την άσκηση 5
2. solveSinWithLeastSquares: Λύνει την προσέγγιση ελαχίστων τετραγώνων για την άσκηση 5
3. solveKarel: Λύνει το πρώτο μέρος της άσκησης 7 για την μετοχή με σύμβολο ΚΑΡΕΛ
4. solveEydap: Λύνει το δεύτερο μέρος της άσκησης 7 για την μετοχή με σύμβολο ΕΥΔΑΠ

## plotLeastSquares
Χρησιμοποιείται για να κάνουμε plot τα αποτελέσματα της LeastSquares (μέθοδος ελαχίστων τετραγώνων). Δέχεται σαν παράμετρους:
1. dic: ένα dictionary με τα σημεία και τις τιμές της συνάρτησης που έχει επιλεχθεί στα σημεία αυτά {x: f(x))} που θα χρησιμοποιήσει η LeastSquares. 
2. degree: Τον βαθμό πολυωνύμου που θα παράξει η LeastSquares 
3. χ1, χ2: Το διάστημα που θα γίνει το plot

Κάνει plot την LeastSquares και επίσης, για σημείο αναφοράς φτιάχνει γραμμές από το ένα σημείο στο επόμενο. Μέσα σε comment είναι η επιλογή (plt.scatter...) να φτιαχτεί μόνο τα σημεία του dictionary και όχι οι γραμμές.


## plotLagrange
Χρησιμοποιείται για να κάνουμε plot τα αποτελέσματα της Lagrange (πολυωνυμικής προσέγγισης). Δέχεται σαν παράμετρους:
1. array: ένα list με τα σημεία με βάση τα οποία η Lagrange θα φτιάξει την προσέγγιση.
2. χ1, χ2: Το διάστημα που θα γίνει το plot

Κάνει plot την Lagrange για το ημίτονο και επίσης, για σημείο αναφοράς κάνει plot τις πραγματικές τιμές του ημίτονου.


## transp
Δέχεται έναν πίνακα και εφόσον ελέγξει πως δεν είναι μια κενή μεταβλητή τότε παράγει τον αντίστροφο του και τον επιστρέφει.

## Lagrange
Υλοποιεί την πολυωνυμική προσέγγιση με πολυώνυμο Lagrange για ορισμένο σημείο. Χρησιμοποιείται στην 5η άσκηση. Δέχεται σαν παράμετρους:
1. x: το σημείο στο οποίο ζητάται η προσέγγιση
2. points: τα σημεία τα οποία ο αλγόριθμος έχει στην διάθεση του για να παράξει την προσέγγιση
3. function: Την συνάρτηση που ζητάται να προσεγγίσει ο αλγόριθμος  


## LeastSquares
Υλοποιεί την προσέγγιση ελάχιστων τετραγώνων. Χρησιμοποιείται στην 5η Άσκηση και άσκηση 7. Δέχεται σαν παράμετρους:
1. dic: ένα dictionary με τα σημεία και τις τιμές της συνάρτησης που έχει επιλεχθεί στα σημεία αυτά {x: f(x))}. 

2. degree: Τον βαθμό πολυωνύμου που θα παραχτεί.

3. χ: Το σημείο στο οποίο θα γίνει η προσέγγιση. Η LeastSquares θα γυρίσει την τιμή της προσεγγιστικής συνάρτησης σε αυτό το σημείο.

  

  Στην αρχή φτιάχνεται ο πίνακας A ο οποίος έχει γραμμές ίσες με το άθροισμα τον σημείων του dic και στήλες ίσες με degree + 1. Επίσης φτιάχνεται ένα list b που αντιπροσωπεύει το ζητούμενο διάνυσμα. Για να γίνει αυτό εκτελούνται δύο λούπες (η μία μέσα στην άλλη) που η πρώτη διανύει τα κλειδιά του dic και η άλλη το range από 0 - (degree+1). Εφόσον παραχθεί ο πίνακας και A και το b διάνυσμα τότε παράγουμε έναν καινούριο πίνακα (matrixToCalculateWith) που είναι ίσος με 
  $$ A^TA $$  
  και ένα διάνυσμα (vectorToCalculateWith) ίσο με
  $$ A^Tb $$
  Έπειτα καλείται η performGaussJordan που εκτελεί τον αλγόριθμο gauss-jordan για matrixToCalculateWith και vectorToCalculateWith και γυρνάει μια λίστα (resultList) που είναι το αποτέλεσμα της gauss-jordan. Το resultList μαζί με την παράμετρο χ δίνεται στην mkFun που γυρνάει το τελικό αποτέλεσμα συνθέτοντας το πολυώνυμο προσέγγισης και χρησιμοποιεί το x πάνω στην προσέγγιση.


## performGaussJordan
Υλοποιεί τον αλγόριθμο gauss-jordan. Δέχεται σαν παράμετρους:
1. array: τον πίνακα που θα χρησιμοποιείσει ο gauss-jordan.
2. vector: το διάνυσμα που θα χρησιμοποιείσει ο gauss-jordan

Τρέχει τριπλή λούπα η μία μέσα στην άλλη. Στην πρώτη περνάει όλες τις γραμμές. Στην δεύτερη περνάει όλες τις γραμμές εκτός από αυτή που περνάει η πρώτη λούπα. Εκεί παράγεται και ο συντελεστής με τον οποίο θα γίνουν οι πράξεις. Επίσης εκεί γίνονται οι πράξεις για τον vector. Η τρίτη λούπα περνάει από κάθε στήλη για την γραμμή που δείχνει η δεύτερη λούπα και κάνει της πράξεις. 

Όταν τελειώσει η τριπλή λούπα παράγεται μια λίστα που για κάθε γραμμή του πίνακα (και του διανύσματος) παίρνει σαν τιμή την διαίρεση των δύο στοιχείον που έχουν αυτά τα δύο αντικείμενα σε αυτή την γραμμή. Έπειτα γυρνάει το παραγώμενο διάνυσμα.

## mkfun
Συνθέτει το τελικό πολυώνυμο στην προσέγγιση ελαχίστων τετραγώνων και γυρνάει το αποτέλεσμα του x για αυτό το πολυώνυμο. 
Δέχεται σαν παράμετρους:

1. vector: μια λίστα που χρησιμοποιήται για την σύνθεση του πολυωνύμου.
2. x: χρησιμοποιείται σαν είσοδο στο πολυώνυμο και έτσι παράγεται το τελικό αποτέλεσμα.

## DayForecast
Αντικείμενο που χρησιμοποιείται στην 7η άσκηση. Περιέχει όλες τις τιμές που ενδιαφέρει την 7η άσκηση για μια μέρα κλεισίματος. Έχει σαν πεδία: 
1. dayNum: Τον αριθμό της ημέρα. Χρησιμοποιείται εσωτερικά στον κώδικα για να καταλαβαίνουν οι αλγόριθμοι ποια μέρα χειρίζονται.
2. date: String με την ημερομηνία. Χρησιμοποιείται στην εκτύπωση των αποτελεσμάτων για να καταλαβαίνει ο χρήστης σε ποια μέρα αναφέροντα τα δεδομένα.
3. original: Η πραγματική τιμή κλεισίματος για εκείνη την μέρα
4. approximation: Η προσέγγιση που έγινε για την τιμή κλεισίματος.
   
### Συναρτήσεις:
diff: υπολογίζει την απόλυτη τιμή της διαφοράς μεταξύ original και approximation.

\_\_str__: χρησιμοποιείται από την print για να εκτυπώσει όλα τα πεδία του αντικειμένου και επίσης την διαφορά μεταξύ original και approximation αν αυτή υπάρχει.


## solveEydap 
Χρησιμοποιείται για τον υπολογισμό τιμών κλεισίματος και την παρουσίαση των αποτελεσμάτων της μετοχής με σύμβολο ΕΥΔΑΠ στην άσκηση 7. 
Δέχεται σαν παράμετρο: 

1. degree: θέτει τον βαθμό του προσεγγιστικού πολυωνύμου που παράγεται 

Αρχικά φτιάχνεται μια λίστα (dates) που αποτελείται από 15 αντικείμενα DayForecast. Το καθένα αντιπροσωπεύει μια μέρα. Με βάση την αρίθμηση, dayNum, τα πρώτα 10 είναι αυτά που χρησιμοποιούμαι για την παράγωγή του πολυωνύμου. Τα υπόλοιπα 5 είναι μόνο για την πρόβλεψη. Έπειτα φτιάχνεται ένα dictionary (pointDic) χρησιμοποιώντας τις 10 πρώτες ημέρες του dates και αυτό θα τροφοδοτηθεί στην LeastSquares. Έπειτα χρησιμοποιόντας το pointDic, degree και την εκάστοτε μέρα θα βρούμε όλες τις προσεγγίσεις και για τις 15 μέρες. Μετά τον υπολογισμό των προσεγγίσεων εκτυπώνονται τα αποτελέσματα στην κονσόλα και επίσης φτιάχνεται μια οπτική παρουσίαση των αποτελεσμάτων χρησιμοποιώντας την συνάρτηση plotLeastSquares.


## solvekarel
Χρησιμοποιείται για τον υπολογισμό τιμών κλεισίματος και την παρουσίαση των αποτελεσμάτων της μετοχής με σύμβολο ΚΑΡΕΛ στην άσκηση 7. 
Δέχεται σαν παράμετρο: 

1. degree: θέτει τον βαθμό του προσεγγιστικού πολυωνύμου που παράγεται 

Αρχικά φτιάχνεται μια λίστα (dates) που αποτελείται από 15 αντικείμενα DayForecast. Το καθένα αντιπροσωπεύει μια μέρα. Με βάση την αρίθμηση, dayNum, τα πρώτα 10 είναι αυτά που χρησιμοποιούμαι για την παράγωγή του πολυωνύμου. Τα υπόλοιπα 5 είναι μόνο για την πρόβλεψη. Έπειτα φτιάχνεται ένα dictionary (pointDic) χρησιμοποιώντας τις 10 πρώτες ημέρες του dates και αυτό θα τροφοδοτηθεί στην LeastSquares. Έπειτα χρησιμοποιόντας το pointDic, degree και την εκάστοτε μέρα θα βρούμε όλες τις προσεγγίσεις και για τις 15 μέρες. Μετά τον υπολογισμό των προσεγγίσεων εκτυπώνονται τα αποτελέσματα στην κονσόλα και επίσης φτιάχνεται μια οπτική παρουσίαση των αποτελεσμάτων χρησιμοποιώντας την συνάρτηση plotLeastSquares.


## plotForDiffLagrange
Χρησιμοποιείται για να παρουσιαστούν οπτικά η διαφορές μεταξύ του ημίτονου και της Lagrange-προσέγγισης του ημιτόνου για 200 ισαπέχων σημεία. 
Δέχεται σαν παράμετρο: 

1. points: μια λίστα με όλες τις τιμές που θα χρησιμοποιηθούν από την lagrange για να γίνει η προσέγγιση.

Αρχικά παράγεται ένα dictionary (pointsToTest) που περιέχει σαν κλειδιά τα 200 σημεία και σαν τιμές την διαφορά μεταξύ ημιτόνου και προσέγγισης του ημιτόνου.

Έπειτα τα δεδομένα παρουσιάζονται είτε με το scatter που δείχνει σε μορφή σημείου την διαφορά μεταξύ των δύο συναρτήσεων είτε με plot που για κάθε x από τα 200 φτιάχνει ένα plot από το 0 - τιμή. 

Τέλος τυπώνεται στην κονσόλα η μέγιστη και η ελάχιστη διαφορά μέσα από το pointsToTest.


## plotForDiffLeastSquares
Χρησιμοποιείται για να παρουσιαστούν οπτικά η διαφορά μεταξύ του ημίτονου και της ελαχίστων-τετραγώνων-προσέγγισης του ημιτόνου για 200 ισαπέχων σημεία για δεδομένο βαθμό πολυωνύμου.

Δέχεται σαν παράμετρο: 
1. pointDic: dictionary που θα χρησιμοποιείσει η LeastSquares για την προσέγγιση.
2. degree: Τον βαθμό πολυωνύμου που θα παράξει η LeastSquares 

Αρχικά παράγεται ένα dictionary (pointsToTest) που περιέχει σαν κλειδιά τα 200 σημεία και σαν τιμές την διαφορά μεταξύ ημιτόνου και προσέγγισης του ημιτόνου.

Έπειτα τα δεδομένα παρουσιάζονται είτε με το scatter που δείχνει σε μορφή σημείου την διαφορά μεταξύ των δύο συναρτήσεων είτε με plot που για κάθε τιμή από τις 200 φτιάχνει ένα plot από το 0 - τιμή για κάθε x.

Τέλος τυπώνεται στην κονσόλα η μέγιστη και η ελάχιστη διαφορά μέσα από το pointsToTest.

## solveSinWithLeastSquares
Φτιάχνει μια παρουσίαση του ζητούμενου της άσκησης 5 για την πολυωνυμική προσέγγιση. 
Δέχεται σαν παραμέτρους:

1. points: τα σημεία τα οποία ο αλγόριθμος έχει στην διάθεση του για να παράξει την προσέγγιση
2. degree: Ο βαθμός του πολυωνύμου που θα παραχτεί

Αρχικά φτιάχνει ένα dictionary (pointDic) με τα points που έχει για τον ημίτονο. Έπειτα καλεί την plotForDiffLeastSquares για να παρουσιαστούν διαγραμματικά οι διαφορές μεταξύ ημίτονου και της προσέγγισης του. Μέσα σε comment υπάρχει η plotLeastSquares που παρουσιάζει τα αποτελέσματα της LeastSquares για [-π, π] μαζί με τα σημεία τα οποία χρησιμοποιήθηκαν για να φτιαχτεί η προσέγγιση.

## solveSinWithLagrange
Φτιάχνει μια παρουσίαση του ζητούμενου της άσκησης 5 για την προσέγγιση ελάχιστων τετραγώνων. 
Δέχεται σαν παραμέτρους:
1. points

Καλεί την plotForDiffLagrange για να παρουσιαστούν διαγραμματικά οι διαφορές μεταξύ ημίτονου και της προσέγγισης του. Μέσα σε comment υπάρχει η plotLagrange που παρουσιάζει τα αποτελέσματα της Lagrange για [-π, π] μαζί με τα σημεία τα οποία χρησιμοποιήθηκαν για να φτιαχτεί η προσέγγιση.


# Περιγραφή λύσεων και αποτελεσμάτων

## Άσκηση 5
Τα σημεία που χρησιμοποιήθηκαν για την παραγωγή των προσεγγίσεων είναι τα (2.9193, -1.9475, -1.379, 2.1096, -0.2275, 0.0781, 1.1325, 2.7807, -2.99, 1.0045). Επιλέχθηκαν τυχαία από αλγόριθμο με εξαίρεση το -2.99.

### Πολυωνυμική προσέγγιση
Για την πολυωνυμική προσέγγιση επιλέχθηκε ο αλγόριθμος Lagrange. Παρακάτω μια γραφική παράσταση της προσέγγισης Lagrange χρησιμοποιόντας την plotLagrange. Με πορτοκαλί είναι οι τιμές της προσέγγισης σε πολλά σημεία για να φαίνεται ομαλή και με μάυρο είναι τα σημεία που χρησιμοποιήθηκαν για να φτιαχτεί η προσέγγιση.
![2c3a1ca4de53cfbffdaddbb64f010979.png](resources/ed27a6db7cf94b05a9ac300e54e67c3c.png)

Παρακάτω το σφάλμα προσέγγισης για 200 σημεία στο [−π, π] καλώντας την plotForDiffLagrange.
![14a502c2d7643edbfd8432c3259d1cde.png](resources/ed1e979aa70640cd90e2c27d575d5e35.png)

Η χειρότερη προσέγγιση ήταν ίση με 
$$ 7.72 * 10^{-5} $$
ενώ η καλύτερη 
$$ 1.19 * 10 ^ {-9} $$
Επιτεύχθηκαν 4 ψηφία ακρίβειας αν πάρουμε την άπειρη νόρμα για αυτά τα 200 σημεία.


### Προσέγγιση ελαχίστων τετραγώνων
Παρακάτω μια γραφική παράσταση της προσέγγισης ελαχίστων τετραγώνων χρησιμοποιόντας την plotLeastSquares για πολυώνυμο 3ου βαθμού. Με πορτοκαλί είναι οι τιμές της προσέγγισης σε διάφορα σημεία για να φαίνεται ομαλή και με μπλε είναι οι τιμές του ημίτονου για τα ίδια διάφορα σημεία. Με μάυρο είναι τα σημεία που χρησιμοποιήθηκαν για να φτιαχτεί η προσέγγιση. 
![2a5dca01bbf4395884ecdf208a80b789.png](resources/9e17fe7134284e4c9d3b0850e7135ecb.png)

Παρακάτω το σφάλμα προσέγγισης για 200 σημεία στο [−π, π] καλώντας την plotForDiffLeastSquares για πολυώνυμο 3ου βαθμού.
![97fad649cea9de0bc8d744be1c417dc6.png](resources/0937cc4de9d64ad49f609874fad04db5.png)
Η χειρότερη προσέγγιση ήταν ίση με 
$$ 0.179302 $$
ενώ η καλύτερη 
$$ 0.001703 $$
Επιτεύχθηκε 1 ψηφίο ακρίβειας αν πάρουμε την άπειρη νόρμα για αυτά τα 200 σημεία.

## Άσκηση 7
Οι μετοχές που επέλεξα έχουν τα σύμβολα ΕΥΔΑΠ και ΚΑΡΕΛ. 
Τα γενέθλια μου είναι στις 8/2. Επομένως οι 10 μέρες που επέλεχθηκαν είναι και για τις δύο μετοχές οι εξής: (*07/2/2020, 06/2/2020, 05/2/2020, 04/2/2020, 03/2/2020, 30/1/2020, 29/1/2020, 28/1/2020, 27/1/2020, 24/1/2020*) ενώ οι 5 μεες μετά: (*14/2/2020, 13/2/2020, 12/2/2020, 11/2/2020, 10/2/2020*).

## Πρώτη μετοχή: ΚΑΡΕΛ

Για 

| Ημερομηνία    | Πραγματική τιμή | Τιμή προσέγγισης | Διαφορά |
| ------------- | --------------- | ---------------- |  ---------------- |
| 14/2/2020 | 2980000 | 3021575.75758 | 41575.757579999976 |
| 13/2/2020 | 2980000 | 3017090.90909 | 37090.909090000205 |
| 12/2/2020 | 2980000 | 3012000.0 | 32000.0 |
| 11/2/2020 | 2900000 | 3006303.0303 | 106303.03030000022 |
| 10/2/2020 | 2920000 | 3000000.0 | 80000.0 |
| 07/2/2020 | 2960000 | 2993090.90909 | 33090.909090000205 |
| 06/2/2020 | 3000000 | 2985575.75758 | 14424.242420000024 |
| 05/2/2020 | 3000000 | 2977454.54545 | 22545.454549999908 |
| 04/2/2020 | 3000000 | 2968727.27273 | 31272.72727000015 |
| 03/2/2020 | 2980000 | 2959393.93939 | 20606.060610000044 |
| 30/1/2020 | 2900000 | 2949454.54545 | 49454.54545000009 |
| 29/1/2020 | 2920000 | 2938909.09091 | 18909.090909999795 |
| 28/1/2020 | 2920000 | 2927757.57576 | 7757.57575999992 |
| 27/1/2020 | 2920000 | 2916000.0 | 4000.0 |
| 24/1/2020 | 2920000 | 2903636.36364 | 16363.636359999888 |
